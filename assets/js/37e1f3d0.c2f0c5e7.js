"use strict";(self.webpackChunkpostman_docs=self.webpackChunkpostman_docs||[]).push([[886],{6080:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"mock-chaos","title":"Mock Servers, Service Virtualization & Chaos Testing","description":"----------------------","source":"@site/docs/010-mock-chaos.md","sourceDirName":".","slug":"/mock-chaos","permalink":"/postman-training/docs/mock-chaos","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/010-mock-chaos.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Mock Servers, Service Virtualization & Chaos Testing","sidebar\\\\_position":9},"sidebar":"tutorialSidebar","previous":{"title":"Monitoring, Orchestration & Alerting","permalink":"/postman-training/docs/monitoring-alerting"},"next":{"title":"G\xe9n\xe9ration de documentation & Publication","permalink":"/postman-training/docs/doc-generation"}}');var r=n(4848),c=n(8453);const t={title:"Mock Servers, Service Virtualization & Chaos Testing",sidebar_position:9},l=void 0,o={},d=[{value:"9.1\xa0Pourquoi mocker\xa0?",id:"91pourquoi-mocker",level:2},{value:"9.2\xa0Cr\xe9er un Mock Server \u2013 pas\u2011\xe0\u2011pas",id:"92cr\xe9er-un-mock-server--pas\xe0pas",level:2},{value:"Facturation Mock",id:"facturation-mock",level:3},{value:"9.3\xa0Service Virtualization \u2013 matching &amp; dynamic",id:"93service-virtualization--matching--dynamic",level:2},{value:"Exemple de r\xe9ponse dynamique",id:"exemple-de-r\xe9ponse-dynamique",level:4},{value:"9.4\xa0Chaos\xa0Testing avec Mock\xa0Servers",id:"94chaostesting-avec-mockservers",level:2},{value:"Latence artificielle",id:"latence-artificielle",level:3},{value:"Erreur al\xe9atoire 30\u202f%",id:"erreur-al\xe9atoire-30",level:3},{value:"Coupe\u2011circuit r\xe9gional",id:"coupecircuit-r\xe9gional",level:3},{value:"9.5\xa0Int\xe9grer mock dans CI",id:"95int\xe9grer-mock-dans-ci",level:2},{value:"CLI substitution baseUrl",id:"cli-substitution-baseurl",level:3},{value:"Contract parity test",id:"contract-parity-test",level:3},{value:"9.6\xa0Publier un Sandbox public",id:"96publier-un-sandbox-public",level:2},{value:"9.7\xa0Check\u2011list Mock &amp; Chaos",id:"97checklist-mock--chaos",level:2}];function a(e){const s={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"91pourquoi-mocker",children:"9.1\xa0Pourquoi mocker\xa0?"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Besoin"}),(0,r.jsx)(s.th,{children:"Sans mock"}),(0,r.jsx)(s.th,{children:"Avec mock Postman"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"D\xe9bloquer front\u2011end avant back\u2011end"}),(0,r.jsx)(s.td,{children:"Sprint bloqu\xe9"}),(0,r.jsx)(s.td,{children:"URL Mock renvoie JSON contractuel"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"D\xe9monstration \xe0 un client"}),(0,r.jsx)(s.td,{children:"Installer backend local"}),(0,r.jsx)(s.td,{children:"Simple URL publique, z\xe9ro infra"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Tests QA sur data stable"}),(0,r.jsx)(s.td,{children:"Data Prod \xe9volue"}),(0,r.jsx)(s.td,{children:"R\xe9ponses fig\xe9es, versionn\xe9es"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Tests de r\xe9silience"}),(0,r.jsx)(s.td,{children:"Doit mettre Prod en panne"}),(0,r.jsx)(s.td,{children:"Mock renvoie pannes contr\xf4l\xe9es"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"92cr\xe9er-un-mock-server--pas\xe0pas",children:"9.2\xa0Cr\xe9er un Mock Server \u2013 pas\u2011\xe0\u2011pas"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["S\xe9lectionner la collection ",(0,r.jsx)(s.strong,{children:"Postman Basics"})," \u279c ",(0,r.jsx)(s.strong,{children:"Mock Servers \u25b8 +\xa0New Mock"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Environment"}),"\u202f: ",(0,r.jsx)(s.code,{children:"staging"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Name"}),"\u202f: ",(0,r.jsx)(s.code,{children:"Echo\u2011Mock"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Mock server type"}),"\u202f: ",(0,r.jsx)(s.em,{children:"Private"})," (Auth API Key) ou ",(0,r.jsx)(s.em,{children:"Public"})," pour partenaires."]}),"\n",(0,r.jsxs)(s.li,{children:["Cocher ",(0,r.jsx)(s.strong,{children:"\u201cSave example responses\u201d"})," \u2192 Postman persistera les bodies que vous envoyez."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Create Mock"})," \u2192 URL g\xe9n\xe9r\xe9e ",(0,r.jsx)(s.code,{children:"https://<uuid>.mock.pstmn.io"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.em,{children:"Tips\xa0:"})," ajoutez le header ",(0,r.jsx)(s.code,{children:"x-mock-match-request-body: true"})," si vous avez plusieurs exemples ",(0,r.jsx)(s.code,{children:"POST /user"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"facturation-mock",children:"Facturation Mock"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Free\xa0: 10\xa0Mock\xa0Servers / 1\u202f000\xa0req/mois."}),"\n",(0,r.jsx)(s.li,{children:"Payant\xa0: 100\xa0Mock / 100\u202f000\xa0req/mois (~0,00005\xa0$/req au\u2011del\xe0)."}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"93service-virtualization--matching--dynamic",children:"9.3\xa0Service Virtualization \u2013 matching & dynamic"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Feature"}),(0,r.jsx)(s.th,{children:"Description"}),(0,r.jsx)(s.th,{children:"Exemple"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.strong,{children:"Path"})," matching"]}),(0,r.jsxs)(s.td,{children:["URL exacte ou templating ",(0,r.jsx)(s.code,{children:":id"})]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/users/:id"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.strong,{children:"Query"})," matching"]}),(0,r.jsxs)(s.td,{children:["Diff\xe9rencie ",(0,r.jsx)(s.code,{children:"?status=active"})]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/users?status=active"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.strong,{children:"Header"})," matching"]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"x-api-version: 2"})}),(0,r.jsx)(s.td,{children:"Versioning header"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.strong,{children:"Body"})," matching"]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"x-mock-match-request-body: true"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"POST /orders"})," diff\xe9rents sch\xe9mas"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Dynamic tokens"})}),(0,r.jsx)(s.td,{children:"Injecter valeur de requ\xeate"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"{{request.body.userId}}"})})]})]})]}),"\n",(0,r.jsx)(s.h4,{id:"exemple-de-r\xe9ponse-dynamique",children:"Exemple de r\xe9ponse dynamique"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "id": "{{request.body.userId}}",\n  "createdAt": "{{$isoTimestamp}}"\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.em,{children:"Pourquoi\xa0?"})," Permet au front-end de voir sa propre saisie refl\xe9t\xe9e."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"94chaostesting-avec-mockservers",children:"9.4\xa0Chaos\xa0Testing avec Mock\xa0Servers"}),"\n",(0,r.jsx)(s.h3,{id:"latence-artificielle",children:"Latence artificielle"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"if (pm.mock) {\n  pm.mock.setDelay(3000); // 3\xa0s\n}\n"})}),"\n",(0,r.jsx)(s.h3,{id:"erreur-al\xe9atoire-30",children:"Erreur al\xe9atoire 30\u202f%"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"if (Math.random() < 0.3) {\n  pm.mock.setStatus(500);\n}\n"})}),"\n",(0,r.jsx)(s.h3,{id:"coupecircuit-r\xe9gional",children:"Coupe\u2011circuit r\xe9gional"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.em,{children:"Cr\xe9er un mock clone"})," nomm\xe9 ",(0,r.jsx)(s.code,{children:"Echo\u2011Mock\u2011eu\u2011down"})," et renvoyer ",(0,r.jsx)(s.strong,{children:"503"})," fixe \u2192 configurez DNS failover pour tester fallback CDN."]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Sc\xe9nario chaos"}),(0,r.jsx)(s.th,{children:"Impact test\xe9"}),(0,r.jsx)(s.th,{children:"Action correctrice attendue"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Latence 3\u202fs"}),(0,r.jsx)(s.td,{children:"Timeout front\u2011end"}),(0,r.jsx)(s.td,{children:"Affichage spinner, retry client"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"30\u202f% erreurs 500"}),(0,r.jsx)(s.td,{children:"Circuit Breaker"}),(0,r.jsx)(s.td,{children:"Fallback cache, alerte SRE"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"503 EU only"}),(0,r.jsx)(s.td,{children:"DNS Failover"}),(0,r.jsx)(s.td,{children:"Route 53 bascule vers US\u2011East"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"95int\xe9grer-mock-dans-ci",children:"9.5\xa0Int\xe9grer mock dans CI"}),"\n",(0,r.jsx)(s.h3,{id:"cli-substitution-baseurl",children:"CLI substitution baseUrl"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:'postman_collection_run:\n  script:\n    - postman collection run "Postman Basics" \\\n        --env "mock-env" \\\n        --export-environment envs/mock-env.json\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"mock-env.json"})," contient ",(0,r.jsx)(s.code,{children:"baseUrl"})," = ",(0,r.jsx)(s.code,{children:"https://<uuid>.mock.pstmn.io"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"contract-parity-test",children:"Contract parity test"}),"\n",(0,r.jsx)(s.p,{children:"Comparez mock vs Swagger\xa0:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"spectral lint openapi.yaml --mockBase https://<uuid>.mock.pstmn.io\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"96publier-un-sandbox-public",children:"9.6\xa0Publier un Sandbox public"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Passer le mock en ",(0,r.jsx)(s.strong,{children:"Public"})," \u2192 URL accessible sans cl\xe9 API."]}),"\n",(0,r.jsxs)(s.li,{children:["Ajouter README\xa0: description, exemples ",(0,r.jsx)(s.code,{children:"curl"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Lister dans ",(0,r.jsx)(s.strong,{children:"Postman Public API Network"})," pour visibilit\xe9."]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Astuce s\xe9curit\xe9\xa0:"})," jamais de donn\xe9es sensibles dans les payloads exemples."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"97checklist-mock--chaos",children:"9.7\xa0Check\u2011list Mock & Chaos"}),"\n",(0,r.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Mock\xa0Server ",(0,r.jsx)(s.code,{children:"Echo\u2011Mock"})," cr\xe9\xe9, URL copi\xe9e."]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Matching path + query + header test\xe9."]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","R\xe9ponse dynamique refl\xe8te ",(0,r.jsx)(s.code,{children:"userId"}),"."]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Sc\xe9nario Chaos latence + erreur 30\u202f% configur\xe9."]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","CI utilise ",(0,r.jsx)(s.code,{children:"mock-env"})," pour tests isol\xe9s."]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Sandbox public document\xe9, pas de donn\xe9es sensibles."]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["\ud83d\udc49 ",(0,r.jsx)(s.strong,{children:"Page suivante"}),"\xa0\u2013 G\xe9n\xe9ration de documentation & Publication\xa0: doc auto Postman, Docusaurus, badges, Postman API Network, versioning."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>l});var i=n(6540);const r={},c=i.createContext(r);function t(e){const s=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(c.Provider,{value:s},e.children)}}}]);