"use strict";(self.webpackChunkpostman_docs=self.webpackChunkpostman_docs||[]).push([[971],{7264:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"data-driven-contract","title":"Data\u2011Driven & Contract Testing","description":"--------------------------------","source":"@site/docs/08-data-driven-contract.md","sourceDirName":".","slug":"/data-driven-contract","permalink":"/postman-training/docs/data-driven-contract","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/08-data-driven-contract.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"title":"Data\u2011Driven & Contract Testing","sidebar\\\\_position":7},"sidebar":"tutorialSidebar","previous":{"title":"JavaScript Scripting\xa0: du basique au Ninja","permalink":"/postman-training/docs/scripting"},"next":{"title":"Monitoring, Orchestration & Alerting","permalink":"/postman-training/docs/monitoring-alerting"}}');var t=s(4848),i=s(8453);const l={title:"Data\u2011Driven & Contract Testing",sidebar_position:7},a=void 0,c={},o=[{value:"7.1\xa0Pourquoi le data\u2011driven\xa0?",id:"71pourquoi-le-datadriven",level:2},{value:"7.2\xa0Collection Runner UI",id:"72collection-runner-ui",level:2},{value:"Pourquoi Runner UI\xa0?",id:"pourquoi-runner-ui",level:3},{value:"7.3\xa0Faker.js\xa0\u2013 g\xe9n\xe9rer bulk data",id:"73fakerjs-g\xe9n\xe9rer-bulk-data",level:2},{value:"7.4\xa0Runner CLI\xa0: Newman vs Postman CLI",id:"74runner-cli-newman-vs-postman-cli",level:2},{value:"Exemple GitHub\xa0Actions \u2013 Postman\xa0CLI",id:"exemple-githubactions--postmancli",level:3},{value:"7.5\xa0Contract testing \u2013 Spectral + Ajv",id:"75contract-testing--spectral--ajv",level:2},{value:"Pourquoi deux niveaux\xa0?",id:"pourquoi-deux-niveaux",level:3},{value:"7.6\xa0Cas edge\xa0&amp; performance",id:"76cas-edge-performance",level:2},{value:"7.6.1\xa0CSV volumineux (&gt;\xa010\u202f000 lignes)",id:"761csv-volumineux-10000-lignes",level:3},{value:"7.6.2\xa0JSON bulk (200\xa0Mo)",id:"762json-bulk-200mo",level:3},{value:"7.6.3\xa0Random seed contr\xf4l\xe9",id:"763random-seed-contr\xf4l\xe9",level:3},{value:"7.6.4\xa0D\xe9tection drift de contrat",id:"764d\xe9tection-drift-de-contrat",level:3},{value:"7.6.5\xa0Runner parall\xe8le (Newman)",id:"765runner-parall\xe8le-newman",level:3},{value:"7.7\xa0Rapports htmlextra &amp; badges",id:"77rapports-htmlextra--badges",level:2},{value:"7.7\xa0Check\u2011list Data\u2011Driven &amp; Contract",id:"77checklist-datadriven--contract",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"71pourquoi-le-datadriven",children:"7.1\xa0Pourquoi le data\u2011driven\xa0?"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Cas d\u2019usage"}),(0,t.jsx)(n.th,{children:"B\xe9n\xe9fice concret"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Cr\xe9er 1\u202f000 utilisateurs test"}),(0,t.jsx)(n.td,{children:"Charge API r\xe9aliste, d\xe9tection de limites 429"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Tester toutes combinaisons de r\xf4le"}),(0,t.jsx)(n.td,{children:"Couverture fonctionnelle exhaustive"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"V\xe9rifier edge\u2011cases (champ vide, null)"}),(0,t.jsx)(n.td,{children:"D\xe9tection r\xe9gressions validation"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"72collection-runner-ui",children:"7.2\xa0Collection Runner UI"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Ouvrez votre collection ",(0,t.jsx)(n.strong,{children:"Postman Basics"})," \u279c ",(0,t.jsx)(n.strong,{children:"Run Collection"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["S\xe9lectionnez le fichier ",(0,t.jsx)(n.code,{children:"users.csv"}),"\xa0:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csv",children:"email,password,role\nalice@example.com,Passw0rd!,ADMIN\nbob@example.com,S3cr3t!,USER\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:["Options\xa0: ",(0,t.jsx)(n.em,{children:"Delay"})," 100\xa0ms, ",(0,t.jsx)(n.em,{children:"Iterations"})," = nombre de lignes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run"})," \u279c onglet ",(0,t.jsx)(n.em,{children:"Test Results"})," affiche un tableau par it\xe9ration."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"pourquoi-runner-ui",children:"Pourquoi Runner UI\xa0?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Debug imm\xe9diat (logs, cookies)."}),"\n",(0,t.jsx)(n.li,{children:"Affiche latence moyenne, p95."}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"73fakerjs-g\xe9n\xe9rer-bulk-data",children:"7.3\xa0Faker.js\xa0\u2013 g\xe9n\xe9rer bulk data"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'// Pre\u2011request \u2013 faker charg\xe9 automatiquement dans sandbox v11\nconst faker = require("faker");\nconst row = {\n  email: faker.internet.email(),\n  password: faker.internet.password(12),\n  role: faker.helpers.randomize(["ADMIN","USER","GUEST"])\n};\npm.variables.set("row", JSON.stringify(row));\n'})}),"\n",(0,t.jsx)(n.p,{children:"Dans le corps\xa0:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:"{{row}}\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Pourquoi ?"})," Plus besoin de maintenir un CSV, donn\xe9es uniques \xe0 chaque run."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"74runner-cli-newman-vs-postman-cli",children:"7.4\xa0Runner CLI\xa0: Newman vs Postman CLI"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Crit\xe8re"}),(0,t.jsxs)(n.th,{children:[(0,t.jsx)(n.strong,{children:"Newman"})," (Node)"]}),(0,t.jsxs)(n.th,{children:[(0,t.jsx)(n.strong,{children:"Postman\xa0CLI"})," (2024+)"]})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Installation"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"npm i -g newman"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"npm i -g @postman/cli"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Source Collection"}),(0,t.jsx)(n.td,{children:"Fichier JSON"}),(0,t.jsx)(n.td,{children:"Stock\xe9e dans Postman Cloud ou JSON"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Reporters"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"cli,json,junit,htmlextra"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"cli,junit,html"})," + Dashboard Cloud"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Auth Postman"}),(0,t.jsx)(n.td,{children:"N/A"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"postman login --with-api-key"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Performance"}),(0,t.jsx)(n.td,{children:"Node 18 d\xe9pendant"}),(0,t.jsx)(n.td,{children:"~20\xa0% plus rapide C++ runtime"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"exemple-githubactions--postmancli",children:"Exemple GitHub\xa0Actions \u2013 Postman\xa0CLI"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'name: API\u2011tests\non: push\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - run: npm i -g @postman/cli\n      - run: postman login --with-api-key ${{ secrets.POSTMAN_KEY }}\n      - run: postman collection run "Postman Basics" -e "staging" --reporters junit,html\n      - uses: actions/upload-artifact@v4\n        with:\n          name: postman-report\n          path: newman\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"75contract-testing--spectral--ajv",children:"7.5\xa0Contract testing \u2013 Spectral + Ajv"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Spectral"}),"\xa0linter OpenAPI\xa0:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"spectral lint openapi.yaml --fail-severity error\n"})}),"\n",(0,t.jsx)(n.p,{children:"Ajoutez dans CI avant la step Postman."}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:"Test de sch\xe9ma \xe0 l\u2019ex\xe9cution\xa0:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const schema = pm.collectionVariables.get("OrderSchema");\nconst data = pm.response.json();\npm.test("Contrat Order", () => pm.expect(ajv.validate(JSON.parse(schema),data)).to.be.true);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"pourquoi-deux-niveaux",children:"Pourquoi deux niveaux\xa0?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Design First"}),"\xa0: Spectral bloque un swagger invalide avant qu\u2019il n\u2019atteigne Postman."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Runtime"}),"\xa0: Ajv garantit que le backend respecte le contrat."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"76cas-edge-performance",children:"7.6\xa0Cas edge\xa0& performance"}),"\n",(0,t.jsx)(n.h3,{id:"761csv-volumineux-10000-lignes",children:"7.6.1\xa0CSV volumineux (>\xa010\u202f000 lignes)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Probl\xe8me\xa0:"})," Runner UI consomme toute la RAM, freeze."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Solutions"}),"\xa0:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Chunk"})," le fichier\xa0:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"split -l 1000 users.csv chunk_\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Utiliser l\u2019option ",(0,t.jsx)(n.code,{children:"--iteration-count"})," avec Newman pour limiter le jeu (ex. 5000) et lancer plusieurs jobs parall\xe8les (matrix CI)."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Ajouter ",(0,t.jsx)(n.code,{children:"--delay-request 50"})," pour \xe9viter 429."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"762json-bulk-200mo",children:"7.6.2\xa0JSON bulk (200\xa0Mo)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Limite UI\xa0:"})," taille max 50\xa0Mo."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Astuce"}),"\xa0: streamer via script Pre\u2011request qui lit ligne par ligne depuis un repo Git brut\xa0:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'if(!pm.variables.get("bulk")){\n  pm.sendRequest("https://raw.githubusercontent.com/org/bulk.json",(e,r)=>{\n    pm.variables.set("bulk", JSON.stringify(r.json()));\n  });\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"763random-seed-contr\xf4l\xe9",children:"7.6.3\xa0Random seed contr\xf4l\xe9"}),"\n",(0,t.jsxs)(n.p,{children:["Pour des tests ",(0,t.jsx)(n.strong,{children:"r\xe9p\xe9tables"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const faker = require("faker");\nfaker.seed(pm.info.iteration); // seed = num\xe9ro d\u2019it\xe9ration\n'})}),"\n",(0,t.jsx)(n.p,{children:"Ainsi, la CI reproduit exactement les m\xeames donn\xe9es."}),"\n",(0,t.jsx)(n.h3,{id:"764d\xe9tection-drift-de-contrat",children:"7.6.4\xa0D\xe9tection drift de contrat"}),"\n",(0,t.jsx)(n.p,{children:"Lorsqu\u2019une r\xe9ponse diverge du sch\xe9ma Ajv\xa0:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'if(!ajv.validate(schema,data)){\n  console.error("DRIFT", ajv.errors);\n  postman.setNextRequest(null); // stop run pour inspecter\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"765runner-parall\xe8le-newman",children:"7.6.5\xa0Runner parall\xe8le (Newman)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npx newman run col.json -n 4 --iteration-count 3000 --delay-request 10 \\\n  --folder Echo --env staging.json &\n"})}),"\n",(0,t.jsx)(n.p,{children:"Quatre processus parall\xe8le pour simuler charge."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"77rapports-htmlextra--badges",children:"7.7\xa0Rapports htmlextra & badges"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"newman run collection.json -e staging.json \\\n  -r cli,htmlextra --reporter-htmlextra-export newman/report.html\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Rapport"})," \u279c graph succ\xe8s/\xe9checs, stats latence, logs assertions.\nAjoutez un ",(0,t.jsx)(n.strong,{children:"badge"})," Postman\xa0CLI dans README\xa0:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"![API\xa0coverage](https://api.getpostman.com/collections/<uid>/badge)\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"77checklist-datadriven--contract",children:"7.7\xa0Check\u2011list Data\u2011Driven & Contract"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Runner UI ex\xe9cut\xe9 sur CSV de 2 lignes."]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Faker.js g\xe9n\xe8re donn\xe9es uniques (email/pwd)."]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pipeline CI (Newman ou Postman\xa0CLI) en place."]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Spectral lint sans erreur sur OpenAPI."]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Tests Ajv de contrat int\xe9gr\xe9s."]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Rapport htmlextra ou Dashboard Cloud archiv\xe9."]}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,t.jsx)(n.strong,{children:"Page suivante"}),"\xa0\u2013 Monitoring, Orchestration & Alerting\xa0: Monitors multi\u2011r\xe9gions, SLI/SLO, int\xe9grations Slack/Datadog."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var r=s(6540);const t={},i=r.createContext(t);function l(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);